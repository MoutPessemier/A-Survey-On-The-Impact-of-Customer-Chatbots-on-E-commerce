---
title: "Thesis Data Analysis"
output:
  html_notebook: default
  pdf_document: default
---

## Libraries

```{r}
if(!require('dplyr')) {
  install.packages('dplyr')
  library('dplyr')
}
if(!require('ggplot2')) {
  install.packages('ggplot2')
  library('ggplot2')
}
if(!require('epiDisplay')) {
  install.packages('epiDisplay')
  library('epiDisplay')
}
if(!require('gmodels')) {
  install.packages('gmodels')
  library('gmodels')
}
```

## Read and prepare data

```{r}
# If you want to run our file, you only have to change this path to the correct path on your local machine.
d <- read.csv("/Users/moutpessemier/Desktop/MT/A-Survey-On-The-Impact-of-Customer-Chatbots-on-E-commerce/DataAnalysis/data.csv", sep=",")
```

The data has been anonimised in Excel. A new column was created called 'taskCategory'. The tasks performed are categorised in one of the following 4 categories:

-   FAQ
-   Personalised question
-   Complaint
-   Sales

From the 63 entries, we had to throw 5 away:

-   3 because of the used chatbot: they were no telecom chatbots.
-   1 entry was a duplicate.
-   1 entry responded with one answer only (only yes and only neutral in part 2)

Some of the columns were renamed to have an easier time working with the variable names

```{r}
names(d)[names(d) == "How.old.are.you."] <- "age"
names(d)[names(d) == "What.is.the.highest.degree.you.currently.have."] <- "degree"
names(d)[names(d) == "What.is.your.gender."] <- "gender"
names(d)[names(d) == "Which.company.s.chatbot.did.you.interact.with."] <- "chatbot"
names(d)[names(d) == "In.what.language.did.you.interact.with.the.chatbot."] <- "language"
names(d)[names(d) == "Through.which.platform.did.you.interact.with.the.chatbot."] <- "platform"

# Comparative study questions
names(d)[names(d) == "Did.you.have.any.difficulties.using.the.chatbot."] <- "q1"
names(d)[names(d) == "The.chatbot.did.not.ask.the.right.questions.to.solve.your.task."] <- "q2"
names(d)[names(d) == "The.chatbot.didn.t.know.what.he.was.talking.about."] <- "q3"
names(d)[names(d) == "Was.the.chatbot.polite."] <- "q4"
names(d)[names(d) == "Did.the.chatbot.fulfil.your.task.correctly."] <- "q5"
names(d)[names(d) == "Was.the.chatbot.easy.to.use."] <- "q6"
names(d)[names(d) == "Was.it.a.task.to.interact.with.the.chatbot."] <- "q7"
names(d)[names(d) == "Did.the.chatbot.need.help.from.a.help.desk.agent.to.complete.your.task."] <- "q8"
names(d)[names(d) == "Did.the.chatbot.contain.enough.knowledge.to.help.with.your.problem."] <- "q9"
names(d)[names(d) == "Did.you.enjoy.interacting.with.the.chatbot."] <- "q10"
names(d)[names(d) == "Was.the.chatbot.capable.of.completing.the.task.on.its.own."] <- "q11"
names(d)[names(d) == "Did.the.chatbot.ask.you.relevant.questions.to.gather.the.information.to.solve.your.task."] <- "q12"
names(d)[names(d) == "Did.the.chatbot.deliver.a.better.quality.of.service.than.a.human."] <- "q13"
names(d)[names(d) == "Did.the.chatbot.interact.in.a.respectful.way."] <- "q14"
names(d)[names(d) == "Was.the.chatbot.unable.to.complete.your.task."] <- "q15"
names(d)[names(d) == "The.service.provided.by.the.human.was.of.better.quality."] <- "q16"
names(d)[names(d) == "Did.you.feel.you.could.trust.the.information.provided.by.the.chatbot."] <- "q17"
names(d)[names(d) == "Did.the.chatbot.perform.the.task.as.you.expected.it.to."] <- "q18"
names(d)[names(d) == "Could.you.solve.your.problem.question.after.using.the.chatbot."] <- "q19"

# Importance Study questions
# Scenario 1
names(d)[names(d) == "The.chatbot.DOES.NOT.execute.the.given.task.successfully."] <- "s1q1"
names(d)[names(d) == "The.chatbot.can.NOT.perform.the.requested.service.to.the.same.level.as.a.human.agent."] <- "s1q2"
names(d)[names(d) == "The.chatbot.knows.at.least.as.much.as.an.agent.about.the.requested.service."] <- "s1q3"
names(d)[names(d) == "The.chatbot.executes.the.given.task.successfully."] <- "s1q4"
names(d)[names(d) == "The.chatbot.knows.less.than.an.agent.about.the.requested.service."] <- "s1q5"
names(d)[names(d) == "The.chatbot.can.perform.the.requested.service.to.the.same.level.as.a.human.agent."] <- "s1q6"

# Scenario 2
names(d)[names(d) == "The.chatbot.DOES.NOT.execute.the.given.task.successfully..1"] <- "s2q1"
names(d)[names(d) == "The.chatbot.can.NOT.perform.the.requested.service.to.the.same.level.as.a.human.agent..1"] <- "s2q2"
names(d)[names(d) == "The.chatbot.knows.at.least.as.much.as.an.agent.about.the.requested.service..1"] <- "s2q3"
names(d)[names(d) == "The.chatbot.executes.the.given.task.successfully..1"] <- "s2q4"
names(d)[names(d) == "The.chatbot.knows.less.than.an.agent.about.the.requested.service..1"] <- "s2q5"
names(d)[names(d) == "The.chatbot.can.perform.the.requested.service.to.the.same.level.as.a.human.agent..1"] <- "s2q6"

# Scenario 3
names(d)[names(d) == "The.chatbot.DOES.NOT.execute.the.given.task.successfully..2"] <- "s3q1"
names(d)[names(d) == "The.chatbot.can.NOT.perform.the.requested.service.to.the.same.level.as.a.human.agent..2"] <- "s3q2"
names(d)[names(d) == "The.chatbot.knows.at.least.as.much.as.an.agent.about.the.requested.service..2"] <- "s3q3"
names(d)[names(d) == "The.chatbot.executes.the.given.task.successfully..2"] <- "s3q4"
names(d)[names(d) == "The.chatbot.knows.less.than.an.agent.about.the.requested.service..2"] <- "s3q5"
names(d)[names(d) == "The.chatbot.can.perform.the.requested.service.to.the.same.level.as.a.human.agent..2"] <- "s3q6"

# General
names(d)[names(d) == "The.chatbot.is.NOT.available.at.all.times."] <- "gq1"
names(d)[names(d) == "The.chatbot.is.easy.to.use."] <- "gq2"
names(d)[names(d) == "The.chatbot.communicates.in.a.robotic...non.empathic.way."] <- "gq3"
names(d)[names(d) == "The.chatbot.is.available.at.all.times."] <- "gq4"
names(d)[names(d) == "The.chatbot.is.NOT.easy.to.use."] <- "gq5"
names(d)[names(d) == "The.chatbot.DOES.NOT.communicate.in.a.robotic...non.empathic.way."] <- "gq6"
```

We make a vector with all questions in:

```{r}
questions1 <- c("Did you have any difficulties using the chatbot?", "The chatbot did not ask the right questions to solve your task?", "The chatbot didn't know what he was talking about?", "Was the chatbot polite?", "Did the chatbot fulfil your task correctly?", "Was the chatbot easy to use?", "Was it a task to interact with the chatbot?", "Did the chatbot need help from a help desk agent to complete your task?", "Did the chatbot contain enough knowledge to help with your problem?", "Did you enjoy interacting with the chatbot?", "Was the chatbot capable of completing the task on its own?", "Did the chatbot ask you relevant questions to gather the information to solve your task?", "Did the chatbot deliver a better quality of service than a human?", "Did the chatbot interact in a respectful way?", "Was the chatbot unable to complete your task?", "The service provided by the human was of better quality?", "Did you feel you could trust the information provided by the chatbot?", "Did the chatbot perform the task as you expected it to?", "Could you solve your problem/question after using the chatbot?")
```

Now we sort per chatbot provider:

```{r}
telenet <- filter(d, chatbot == "Telenet")
proximus <- filter(d, chatbot == "Proximus")
orange <- filter(d, chatbot == "Orange")
tMobile <- filter(d, chatbot == "T-Mobile")
KPN <- filter(d, chatbot == "KPN")
```

## Data Exploration

### Telenet

```{r}
meanAgeTelenet = mean(telenet$age)
meanAgeTelenet
varAgeTelenet = sd(telenet$age)
varAgeTelenet

barplot(table(telenet$taskCategory),
        main="Frequency of each category in Telenet",
        xlab="Task Category",
        ylab="Count",
        col="blue",
        ylim = c(0,18))

barplot(table(telenet$language),
        main="Frequency of each language interaction in Telenet",
        xlab="Task Category",
        ylab="Count",
        col="blue",
        ylim = c(0,18))

barplot(table(telenet$platform),
        main="Frequency of each platform in Telenet",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(telenet$gender),
        main="Frequency of each gender in Telenet",
        xlab="Task Category",
        ylab="Count",
        col=c("red", "blue"))

barplot(table(telenet$degree),
        main="Frequency of each degree in Telenet",
        xlab="Task Category",
        ylab="Count",
        cex.names=0.55,
        col="blue")
```

### Proximus

```{r}
meanAgeProximus = mean(proximus$age)
meanAgeProximus
varAgeProximus = sd(proximus$age)
varAgeProximus

b <- barplot(table(proximus$taskCategory),
        main="Frequency of each category in Proximus",
        xlab="Task Category",
        ylab="Count",
        col="blue",
        ylim = c(0,10))

barplot(table(proximus$language),
        main="Frequency of each language interaction in Proximus",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(proximus$platform),
        main="Frequency of each platform in Proximus",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(proximus$gender),
        main="Frequency of each gender in Proximus",
        xlab="Task Category",
        ylab="Count",
        col=c("red", "blue"))

barplot(table(proximus$degree),
        main="Frequency of each degree in Proximus",
        xlab="Task Category",
        ylab="Count",
        cex.names=0.55,
        col="blue",
        ylim = c(0,10))
```

### T-Mobile

```{r}
meanAgeTmobile = mean(tMobile$age)
meanAgeTmobile
varAgeTmobile = sd(tMobile$age)
varAgeTmobile

barplot(table(tMobile$taskCategory),
        main="Frequency of each category in T-Mobile",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(tMobile$language),
        main="Frequency of each language interaction in T-Mobile",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(tMobile$platform),
        main="Frequency of each platform in T-Mobile",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(tMobile$gender),
        main="Frequency of each gender in T-Mobile",
        xlab="Task Category",
        ylab="Count",
        col=c("blue"))

barplot(table(tMobile$degree),
        main="Frequency of each degree in T-Mobile",
        xlab="Task Category",
        ylab="Count",
        cex.names=0.55,
        col="blue")
```

### Orange

```{r}
meanAgeOrange = mean(orange$age)
meanAgeOrange
varAgeOrange = sd(orange$age)
varAgeOrange

barplot(table(orange$taskCategory),
        main="Frequency of each category in Orange",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(orange$language),
        main="Frequency of each language interaction in Orange",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(orange$platform),
        main="Frequency of each platform in Orange",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(orange$gender),
        main="Frequency of each gender in Orange",
        xlab="Task Category",
        ylab="Count",
        col=c("blue"))

barplot(table(orange$degree),
        main="Frequency of each degree in Orange",
        xlab="Task Category",
        ylab="Count",
        cex.names=0.55,
        col="blue")
```

### KPN

```{r}
meanAgeKPN = mean(KPN$age)
meanAgeKPN
varAgeKPN = sd(KPN$age)
varAgeKPN

barplot(table(KPN$taskCategory),
        main="Frequency of each category in KPN",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(KPN$language),
        main="Frequency of each language interaction in KPN",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(KPN$platform),
        main="Frequency of each platform in KPN",
        xlab="Task Category",
        ylab="Count",
        col="blue")

barplot(table(KPN$gender),
        main="Frequency of each gender in KPN",
        xlab="Task Category",
        ylab="Count",
        col=c("red", "blue", "green"))

barplot(table(KPN$degree),
        main="Frequency of each degree in KPN",
        xlab="Task Category",
        ylab="Count",
        cex.names=0.55,
        col="blue")
```

### Environment variables

#### Age

```{r}
ggplot(d, aes(x=chatbot, y=age)) + geom_point(colour="black", size=1) + stat_summary(fun=mean, geom="point", shape=1, size=2, colour="red", fill="red") + ggtitle("Age per chatbot provider")
tab1(d$age, sort.group = "decreasing", cum.percent = FALSE)
mean(d$age)
sd(d$age)
```

#### Degree

```{r}
dfDegree <- d %>%
  group_by(degree) %>%
  count() %>%
  ungroup() %>%
  mutate(perc = `n` / sum(`n`)) %>%
  arrange(perc) %>%
  mutate(labels = scales::percent(perc))

ggplot(dfDegree, aes(x="",y=perc, fill=degree)) + geom_col() + coord_polar(theta="y") + geom_text(aes(label = labels), position = position_stack(vjust = 0.5))

tab1(d$degree, sort.group = "decreasing", cum.percent = FALSE)
```

#### Gender

```{r}
dfGender <- d %>%
  group_by(gender) %>%
  count() %>%
  ungroup() %>%
  mutate(perc = `n` / sum(`n`)) %>%
  arrange(perc) %>%
  mutate(labels = scales::percent(perc))

ggplot(dfGender, aes(x="",y=perc, fill=gender)) + geom_col() + coord_polar(theta="y") + geom_text(aes(label = labels), position = position_stack(vjust = 0.5))

tab1(d$gender, sort.group = "decreasing", cum.percent = FALSE)
```

#### Chatbot

```{r}
dfChatbot <- d %>%
  group_by(chatbot) %>%
  count() %>%
  ungroup() %>%
  mutate(perc = `n` / sum(`n`)) %>%
  arrange(perc) %>%
  mutate(labels = scales::percent(perc))

ggplot(dfChatbot, aes(x="",y=perc, fill=chatbot)) + geom_col() + coord_polar(theta="y") + geom_text(aes(label = labels), position = position_stack(vjust = 0.5))
tab1(d$chatbot, sort.group = "decreasing", cum.percent = FALSE)
```

#### Language

```{r}
dfLang <- d %>%
  group_by(language) %>%
  count() %>%
  ungroup() %>%
  mutate(perc = `n` / sum(`n`)) %>%
  arrange(perc) %>%
  mutate(labels = scales::percent(perc))

ggplot(dfLang, aes(x="",y=perc, fill=language)) + geom_col() + coord_polar(theta="y") + geom_text(aes(label = labels), position = position_stack(vjust = 0.5))

tab1(d$language, sort.group = "decreasing", cum.percent = FALSE)
```

#### Platform

```{r}
dfPlat <- d %>%
  group_by(platform) %>%
  count() %>%
  ungroup() %>%
  mutate(perc = `n` / sum(`n`)) %>%
  arrange(perc) %>%
  mutate(labels = scales::percent(perc))

ggplot(dfPlat, aes(x="",y=perc, fill=platform)) + geom_col() + coord_polar(theta="y") + geom_text(aes(label = labels), position = position_stack(vjust = 0.5))

tab1(d$platform, sort.group = "decreasing", cum.percent = FALSE)
```

## Comparative Study

```{r}
FAQ <- filter(d, taskCategory == "FAQ")
ComplaintsQ <- filter(d, taskCategory == "Complaint")
SalesQ <- filter(d, taskCategory == "Sales")
PersonalQ <- filter(d, taskCategory == "Personalised Question")
```

#### FAQ

```{r}
for(i in 1: 19){
  yes <- table(FAQ[[paste0("q", i)]])["1"]
  no <- table(FAQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(FAQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### Sales

```{r}
for(i in 1: 19){
  yes <- table(SalesQ[[paste0("q", i)]])["1"]
  no <- table(SalesQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(SalesQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### Complaints

```{r}
for(i in 1: 19){
  yes <- table(ComplaintsQ[[paste0("q", i)]])["1"]
  no <- table(ComplaintsQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(ComplaintsQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### Personal questions

```{r}
for(i in 1: 19){
  yes <- table(PersonalQ[[paste0("q", i)]])["1"]
  no <- table(PersonalQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(PersonalQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### Telenet

```{r}
for(i in 1: 19){
  yes <- table(telenet[[paste0("q", i)]])["1"]
  no <- table(telenet[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(telenet[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### Proximus

```{r}
for(i in 1: 19){
  yes <- table(proximus[[paste0("q", i)]])["1"]
  no <- table(proximus[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(proximus[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### T-Mobile

```{r}
for(i in 1: 19){
  yes <- table(tMobile[[paste0("q", i)]])["1"]
  no <- table(tMobile[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(tMobile[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### Orange

```{r}
for(i in 1: 19){
  yes <- table(orange[[paste0("q", i)]])["1"]
  no <- table(orange[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(orange[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### KPN

```{r}
for(i in 1: 19){
  yes <- table(KPN[[paste0("q", i)]])["1"]
  no <- table(KPN[[paste0("q", i)]])["2"]

  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0

  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }

  b <- barplot(table(KPN[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### Categories For Telenet

```{r}
TFAQ <- filter(telenet, taskCategory == "FAQ")
TComplaintsQ <- filter(telenet, taskCategory == "Complaint")
TSalesQ <- filter(telenet, taskCategory == "Sales")
TPersonalQ <- filter(telenet, taskCategory == "Personalised Question")
```

#### FAQ

```{r}
for(i in 1: 19){
  yes <- table(TFAQ[[paste0("q", i)]])["1"]
  no <- table(TFAQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(TFAQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

#### Complaints

```{r}
for(i in 1: 19){
  yes <- table(TComplaintsQ[[paste0("q", i)]])["1"]
  no <- table(TComplaintsQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(TComplaintsQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

#### Sales

```{r}
for(i in 1: 19){
  yes <- table(TSalesQ[[paste0("q", i)]])["1"]
  no <- table(TSalesQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(TSalesQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

#### Personal Questions

```{r}
for(i in 1: 19){
  yes <- table(TPersonalQ[[paste0("q", i)]])["1"]
  no <- table(TPersonalQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(TPersonalQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

### Categories For Proximus

```{r}
PFAQ <- filter(proximus, taskCategory == "FAQ")
PComplaintsQ <- filter(proximus, taskCategory == "Complaint")
PSalesQ <- filter(proximus, taskCategory == "Sales")
PPersonalQ <- filter(proximus, taskCategory == "Personalised Question")
```

#### FAQ

```{r}
for(i in 1: 19){
  yes <- table(PFAQ[[paste0("q", i)]])["1"]
  no <- table(PFAQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(PFAQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

#### Complaints

```{r}
for(i in 1: 19){
  yes <- table(PComplaintsQ[[paste0("q", i)]])["1"]
  no <- table(PComplaintsQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(PComplaintsQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

#### Sales

```{r}
for(i in 1: 19){
  yes <- table(PSalesQ[[paste0("q", i)]])["1"]
  no <- table(PSalesQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(PSalesQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

#### Personal Questions

```{r}
for(i in 1: 19){
  yes <- table(PPersonalQ[[paste0("q", i)]])["1"]
  no <- table(PPersonalQ[[paste0("q", i)]])["2"]
  
  yes[is.na(yes)] <- 0
  no[is.na(no)] <- 0
  
  ynlabels <- c()
  ynval <- c()
  ynpos <- c()

  if(yes > 0 && no > 0) {
    ynlabels <- c("yes", "no")
    ynval <- c(yes, no)
    ynpos <- c(yes+1,no+1)
  }
  if ( yes > 0 && no == 0) {
    ynlabels <- c("yes")
    ynval <- c(yes)
    ynpos <- c(yes+1)
  }
  if (yes == 0 && no > 0) {
    ynlabels <- c("no")
    ynval <- c(no)
    ynpos <- c(no+1)
  }
  
  b <- barplot(table(PPersonalQ[[paste0("q", i)]]),
          main=questions1[i],
          ylab="Count",
          names.arg = ynlabels,
          col="blue",
          ylim = c(0,28))
  abline(v=c(1.3) , col="grey")
  text(b, y=ynpos, paste("n: ", ynval , sep=""), cex=1, col = "red")
}
```

## Importance Study

```{r}
scenarioQuestions <- c('The chatbot DOES NOT execute the given task successfully.', 'The chatbot can NOT perform the requested service to the same level as a human agent.','The chatbot knows at least as much as an agent about the requested service.', 'The chatbot executes the given task successfully.', 'The chatbot knows less than an agent about the requested service.', 'The chatbot can perform the requested service to the same level as a human agent.')
generalQuestions <- c('The chatbot is NOT available at all times.', 'The chatbot is easy to use.', 'The chatbot communicates in a robotic, non-empathic way.','The chatbot is available at all times.', 'The chatbot is NOT easy to use.', 'The chatbot DOES NOT communicate in a robotic, non-empathic way.')
kano_categories <- c('like', 'must-be','neutral','live-with','dislike')
df <- data.frame(matrix(ncol = 8, nrow = 0))
x <- c("attribute", "Q", "M", "A", "I", "P", "R", "label")
colnames(df) <- x
attrNames <- c("Execute requested tasks", "Number of services available in the chatbot", "Contains breadth of knowledge", "Available at all times", "Ease of use", "Create an enjoyable interaction")
```

### Kano Category Table

|                  | 1\. dislike | 2\. live-with | 3\. neutral | 4\. must-be | 5\. like |
|:----------------:|:-----------:|:-------------:|:-----------:|:-----------:|:--------:|
|  **1. dislike**  |      Q      |       R       |      R      |      R      |    R     |
| **2. live-with** |      M      |       I       |      I      |      I      |    R     |
|  **3. neutral**  |      M      |       I       |      I      |      I      |    R     |
|  **4. must-be**  |      M      |       I       |      I      |      I      |    R     |
|   **5. like**    |      P      |       A       |      A      |      A      |    Q     |

-   Q = Questionable = When the user puts in contradictory responses
-   A = Attractive
-   P = Performance
-   M = Must-be
-   I = Indifferent
-   R = Reverse

#### Scenario 1

```{r}
for (i in 1: 3) {
  if(i == 1) {
    t <- table(factor(d$s1q4, levels = 1:5),factor(d$s1q1, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[4], scenarioQuestions[1])
  } else if (i == 2) {
    t <- table(factor(d$s1q6, levels = 1:5),factor(d$s1q2, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[6], scenarioQuestions[2])
  } else {
    t <- table(factor(d$s1q3, levels = 1:5),factor(d$s1q5, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[3], scenarioQuestions[5])
  }
  colnames(t) <- kano_categories
  rownames(t) <- kano_categories

  attributeName <- paste0("S", 1, ": ", attrNames[i])
  Q <- t[1,1] + t[5,5]
  M <- t[2,1] + t[3,1] + t[4,1]
  A <- t[5,2] + t[5,3] + t[5,4]
  I <- t[2,2] + t[2,3] + t[2,4] + t[3,2] + t[3,3] + t[3,4] + t[4,2] + t[4,3] + t[4,4]
  P <- t[5,1]
  R <- t[1,2] + t[1,3] + t[1,4] + t[1,5] + t[2,5] + t[3,5] + t[4,5]

  cats <- c(Q, M, A, I, P, R)
  biggest <- max(cats)
  biggest

  cat <- ""

  if(biggest == Q) {
    cat <- "Q"
  } else if (biggest == A) {
    cat <- "A"
  } else if (biggest == P) {
    cat <- "P"
  } else if (biggest == M) {
    cat <- "M"
  } else if (biggest == I) {
    cat <- "I"
  } else {
    cat <- "R"
  }

  df[nrow(df) + 1,] = c(attributeName, Q, M, A, I, P, R, cat)
}
df
```

#### Scenario 2

```{r}
for (i in 1: 3) {
  if(i == 1) {
    t <- table(factor(d$s2q4, levels = 1:5),factor(d$s2q1, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[4], scenarioQuestions[1])
  } else if (i == 2) {
    t <- table(factor(d$s2q6, levels = 1:5),factor(d$s2q2, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[6], scenarioQuestions[2])
  } else {
    t <- table(factor(d$s2q3, levels = 1:5),factor(d$s2q5, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[3], scenarioQuestions[5])
  }
  colnames(t) <- kano_categories
  rownames(t) <- kano_categories

  attributeName <- paste0("S", 2, ": ", attrNames[i])
  Q <- t[1,1] + t[5,5]
  M <- t[2,1] + t[3,1] + t[4,1]
  A <- t[5,2] + t[5,3] + t[5,4]
  I <- t[2,2] + t[2,3] + t[2,4] + t[3,2] + t[3,3] + t[3,4] + t[4,2] + t[4,3] + t[4,4]
  P <- t[5,1]
  R <- t[1,2] + t[1,3] + t[1,4] + t[1,5] + t[2,5] + t[3,5] + t[4,5]

  cats <- c(Q, M, A, I, P, R)
  biggest <- max(cats)
  biggest

  cat <- ""

  if(biggest == Q) {
    cat <- "Q"
  } else if (biggest == A) {
    cat <- "A"
  } else if (biggest == P) {
    cat <- "P"
  } else if (biggest == M) {
    cat <- "M"
  } else if (biggest == I) {
    cat <- "I"
  } else {
    cat <- "R"
  }

  df[nrow(df) + 1,] = c(attributeName, Q, M, A, I, P, R, cat)
}
df
```

#### Scenario 3

```{r}
for (i in 1: 3) {
  if(i == 1) {
    t <- table(factor(d$s3q4, levels = 1:5),factor(d$s3q1, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[4], scenarioQuestions[1])
  } else if (i == 2) {
    t <- table(factor(d$s3q6, levels = 1:5),factor(d$s3q2, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[6], scenarioQuestions[2])
  } else {
    t <- table(factor(d$s3q3, levels = 1:5),factor(d$s3q5, levels = 1:5))
    names(dimnames(t)) <- c(scenarioQuestions[3], scenarioQuestions[5])
  }
  colnames(t) <- kano_categories
  rownames(t) <- kano_categories

  attributeName <- paste0("S", 3, ": ", attrNames[i])
  Q <- t[1,1] + t[5,5]
  M <- t[2,1] + t[3,1] + t[4,1]
  A <- t[5,2] + t[5,3] + t[5,4]
  I <- t[2,2] + t[2,3] + t[2,4] + t[3,2] + t[3,3] + t[3,4] + t[4,2] + t[4,3] + t[4,4]
  P <- t[5,1]
  R <- t[1,2] + t[1,3] + t[1,4] + t[1,5] + t[2,5] + t[3,5] + t[4,5]

  cats <- c(Q, M, A, I, P, R)
  biggest <- max(cats)
  biggest

  cat <- ""

  if(biggest == Q) {
    cat <- "Q"
  } else if (biggest == A) {
    cat <- "A"
  } else if (biggest == P) {
    cat <- "P"
  } else if (biggest == M) {
    cat <- "M"
  } else if (biggest == I) {
    cat <- "I"
  } else {
    cat <- "R"
  }

  df[nrow(df) + 1,] = c(attributeName, Q, M, A, I, P, R, cat)
}
df
```

#### General

```{r}
for (i in 1: 3) {
  if(i == 1) {
    t <- table(factor(d$gq4, levels = 1:5),factor(d$gq1, levels = 1:5))
    names(dimnames(t)) <- c(generalQuestions[4], generalQuestions[1])
  } else if(i == 2) {
    t <- table(factor(d$gq2, levels = 1:5),factor(d$gq5, levels = 1:5))
    names(dimnames(t)) <- c(generalQuestions[2], generalQuestions[5])
  } else {
    t <- table(factor(d$gq3, levels = 1:5),factor(d$gq6, levels = 1:5))
    names(dimnames(t)) <- c(generalQuestions[3], generalQuestions[6])
  }
  colnames(t) <- kano_categories
  rownames(t) <- kano_categories

  attributeName <- attrNames[i+3]
  Q <- t[1,1] + t[5,5]
  M <- t[2,1] + t[3,1] + t[4,1]
  A <- t[5,2] + t[5,3] + t[5,4]
  I <- t[2,2] + t[2,3] + t[2,4] + t[3,2] + t[3,3] + t[3,4] + t[4,2] + t[4,3] + t[4,4]
  P <- t[5,1]
  R <- t[1,2] + t[1,3] + t[1,4] + t[1,5] + t[2,5] + t[3,5] + t[4,5]

  cats <- c(Q, M, A, I, P, R)
  biggest <- max(cats)
  biggest

  cat <- ""

  if(biggest == Q) {
    cat <- "Q"
  } else if (biggest == A) {
    cat <- "A"
  } else if (biggest == P) {
    cat <- "P"
  } else if (biggest == M) {
    cat <- "M"
  } else if (biggest == I) {
    cat <- "I"
  } else {
    cat <- "R"
  }

  df[nrow(df) + 1,] = c(attributeName, Q, M, A, I, P, R, cat)
}
df
```

### Satisfaction and dissatisfaction coefficient

```{r}
satDf <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("Attribute", "Satisfaction Coefficient", "Dissatisfaction Coefficient")
colnames(satDf) <- x
for (row in 1:nrow(df)) {
  name <- df[row, "attribute"]
  Q <- strtoi(df[row, "Q"], base = 0L)
  M <- strtoi(df[row, "M"], base = 0L)
  A <- strtoi(df[row, "A"], base = 0L)
  I <- strtoi(df[row, "I"], base = 0L)
  P <- strtoi(df[row, "P"], base = 0L)
  R <- strtoi(df[row, "R"], base = 0L)

  satCoef <- round((A+P)/(A+P+M+I), digits = 2)
  dissatCoef <- round((P+M)/(A+P+M+I)*-1, digits = 2)
  satDf[nrow(satDf) + 1,] = c(name, satCoef, dissatCoef)
}
satDf
```

### Scatterplot

```{r}
satDf$`Satisfaction Coefficient` <- as.numeric(satDf$`Satisfaction Coefficient`)
satDf$`Dissatisfaction Coefficient` <- as.numeric(satDf$`Dissatisfaction Coefficient`)

ggplot(satDf, aes(x=`Satisfaction Coefficient`, 
                  y=-`Dissatisfaction Coefficient`)) + 
  geom_label(x = 0.0, y = 0.55, label = 'Must - be', hjust = 0) +
  geom_label(x = 0.0, y = 0.45, label = 'Indifferent', hjust = 0) +
  geom_label(x = 1, y = 0.55, label = 'Performance', hjust = 1) +
  geom_label(x = 1, y = 0.45, label = 'Attractive', hjust = 1) +
  geom_point(col = 'deepskyblue3', size = 3) + 
  geom_text(aes(label = seq(nrow(satDf))), size = 3, nudge_x = 0.02,
            nudge_y = -0.015, check_overlap = TRUE) +
  # if labels are overlapping, change positions with this
  geom_text(aes(label = 4), size = 3, nudge_x = -0.015,
                nudge_y = 0.02, data = satDf[4,]) +
  theme_light() +
  theme(panel.grid = element_blank()) +
  geom_hline(yintercept = 0.5) +
  geom_vline(xintercept = 0.5) +
  scale_y_continuous(labels = function(x) paste0('-', x),
                     limits = c(0, 1)) +
  xlim(c(0, 1))
```
